# Модуль "Мировой поисковик университетов и программ"

## Обзор

Модуль поиска университетов и программ для платформы UniChance предоставляет комплексную систему поиска, фильтрации и оценки шансов поступления в зарубежные университеты.

## Архитектура

### Backend (Node.js + TypeScript + Express)

- **REST API** с эндпоинтами для поиска, университетов, программ, оценки шансов и отзывов
- **PostgreSQL** база данных с оптимизированными индексами
- **ML модель** для предсказания вероятности поступления
- **Шифрование** персональных данных
- **Аутентификация** через JWT

### Frontend (React + TypeScript)

- Интерфейс поиска с расширенными фильтрами
- Карточки университетов и программ
- Интеграция с существующим интерфейсом UniChance

### ETL Процессы

- Импорт данных из открытых источников (QS Rankings, Times Higher Education)
- Веб-скрапинг с соблюдением robots.txt и rate limiting
- Парсинг Common Data Set (CDS) для US университетов

## Установка и запуск

### 1. Backend

```bash
cd backend
npm install
cp .env.example .env
# Настройте .env файл
npm run dev
```

### 2. База данных

```bash
# Создайте базу данных
createdb unichance

# Запустите миграции
psql -d unichance -f ../database/migrations/001_initial_schema.sql
psql -d unichance -f ../database/migrations/002_add_search_indexes.sql
```

### 3. ETL (опционально)

```bash
cd etl
npm install
tsx import_qs_rankings.ts
tsx import_university_data.ts
```

## API Endpoints

### Поиск

```
GET /api/search
Query parameters:
- query: текст поиска
- country: код страны (US, GB, etc.)
- city: название города
- region: регион (USA, UK, Europe, etc.)
- field_of_study: направление обучения
- degree_level: уровень (Bachelor, Master, PhD)
- language: язык программы
- min_tuition, max_tuition: диапазон стоимости
- has_scholarship: наличие стипендий
- deadline_before: дедлайн до даты
- limit, offset: пагинация
```

### Университеты

```
GET /api/universities - список университетов
GET /api/universities/:id - детали университета
```

### Программы

```
GET /api/programs/:id - детали программы
```

### Оценка шансов

```
POST /api/chances/calculate
Body: {
  program_id: number,
  gpa: number,
  gpa_scale: '4.0' | '5.0' | '100',
  english_test?: 'IELTS' | 'TOEFL',
  english_score?: number,
  sat_score?: number,
  gre_score?: number,
  has_portfolio: boolean,
  work_experience_years: number,
  achievements_count: number
}
```

### Отзывы

```
GET /api/reviews - список отзывов
POST /api/reviews - создать отзыв (требует аутентификации)
```

## Безопасность

### Шифрование данных

- Персональные данные пользователей шифруются с помощью AES-256-GCM
- Ключ шифрования хранится в переменной окружения `ENCRYPTION_KEY`
- Данные в полях `encrypted_profile_data` и `encrypted_application_data` хранятся в зашифрованном виде

### Анонимизация отзывов

- Отзывы могут быть анонимными (флаг `anonymous`)
- Имена пользователей скрываются при анонимных отзывах
- Используется хеширование для дополнительной анонимизации

### Аутентификация

- JWT токены для аутентификации
- Пароли хешируются с помощью bcrypt
- Токены имеют срок действия (по умолчанию 7 дней)

## ML Модель

Модель оценки шансов использует:

1. **Логистическую регрессию** на основе признаков:
   - GPA (нормализованный к 4.0)
   - Результаты языковых тестов (IELTS/TOEFL)
   - Стандартизированные тесты (SAT, GRE, GMAT)
   - Портфолио и достижения
   - Опыт работы

2. **Исторические данные**:
   - Средние показатели принятых студентов
   - Процент приема за последние 3 года
   - Корректировка на основе реальных данных

3. **Факторы влияния**:
   - Рейтинг университета
   - Конкуренция
   - Требования программы

## План расширения

### Краткосрочные улучшения

1. **Дополнительные источники данных**:
   - Times Higher Education Rankings API
   - Studyportals API
   - Официальные API университетов

2. **Улучшение ML модели**:
   - Обучение на реальных данных поступлений
   - Добавление большего количества признаков
   - A/B тестирование точности предсказаний

3. **Многоязычность**:
   - Поддержка английского интерфейса
   - Локализация данных университетов

### Долгосрочные планы

1. **Мобильное приложение**:
   - React Native версия
   - Push-уведомления о дедлайнах
   - Офлайн режим

2. **Расширенные функции**:
   - Краткосрочные программы (летние школы, стажировки)
   - Система рекомендаций на основе ML
   - Интеграция с системами подачи заявок

3. **Аналитика**:
   - Дашборд для университетов
   - Статистика поступления
   - Тренды в образовании

## Лицензионные ограничения

- **QS Rankings**: Использовать только для верификации данных. Требуется API ключ или соблюдение условий использования при скрапинге.
- **Times Higher Education**: Соблюдать условия использования при импорте данных.
- **WHED (World Higher Education Database)**: Использовать только для верификации, не для коммерческого использования данных.

## Поддержка

Для вопросов и предложений создайте issue в репозитории проекта.